\chapter{Background}\label{chap:background}

Section~\ref{sec:datasets} provides an overview of two widely used datasets in the field of network intrusion detection: the CTU13 dataset~\cite{garcia2014empirical} and the CICIDS2017 dataset~\cite{sharafaldin2018toward}. Researchers have extensively utilised these datasets to develop and evaluate machine learning-based NIDS.\@ Understanding the datasets' characteristics, strengths, and limitations used to train machine learning models is essential for designing robust and effective intrusion detection systems.

Section~\ref{sec:classifiers} discusses two popular machine learning classifiers, Random Forest and Support Vector Machine, widely used in network intrusion detection systems. The strengths and limitations of these classifiers are highlighted, along with their performance on different datasets. Understanding the capabilities and trade-offs of the classifiers used in a machine learning NIDS is crucial for selecting appropriate models for intrusion detection.

Section~\ref{sec:explainable} introduces explainable AI techniques, which aim to provide insights into the decision-making process of machine learning models. These techniques help us understand the factors that contribute to the predictions made by the models and offer interpretable explanations for their outputs. Understanding the importance of the features a model uses to predict benign or malicious network flows is essential for validating the reliability of machine learning models and gaining insights into their decision-making process.

\section{CTU13 and CICIDS2017 Datasets}\label{sec:datasets}

The availability of representative and labelled datasets is crucial for developing and evaluating machine learning-based network intrusion detection systems. Two widely used benchmark datasets in this domain are the CTU13 dataset~\cite{garcia2014empirical} and the CICIDS2017 dataset~\cite{sharafaldin2018toward}.

Garcia et al.~\cite{garcia2014empirical} introduced the CTU13 dataset, which contains real botnet traffic captured in a controlled environment. The dataset consists of 13 scenarios, each representing specific botnet behaviours such as port scanning, DDoS attacks, click fraud, and spam. The authors provide a detailed description of the dataset creation methodology, including the setup of the controlled environment, the use of actual botnet samples, and the labelling process based on the known behaviour of the captured botnets. They also present an evaluation of the dataset using various machine learning algorithms, demonstrating its utility for botnet detection research. The realistic nature of the CTU13 dataset and the variety of botnet scenarios it covers have made it a popular choice among researchers.

Table~\ref{tab:ctu13_breakdown} shows the breakdown of classes in the CTU13 dataset.

\begin{table}[ht]
    \centering
    \begin{tabular}{|l|c|} 
    \hline
    \textbf{Class} & \textbf{Count} \\
    \hline
    Benign & 213,326 \\
    \hline
    Botnet & 15,559 \\
    \hline
    \end{tabular}
    \caption{CTU13 Dataset Class Breakdown}\label{tab:ctu13_breakdown}
\end{table}

Sharafaldin et al.~\cite{sharafaldin2018toward} created the CICIDS2017 dataset, a more recent and comprehensive dataset for evaluating network intrusion detection systems. The dataset contains many modern attacks, including DoS, DDoS, brute force, XSS, SQL injection, and infiltration. The authors describe the dataset generation process, which involved creating a controlled lab environment resembling a real-world network infrastructure. They used tools and scripts to generate realistic benign traffic and attack scenarios. The dataset also includes a combination of manually labelled and time-based labelled data. The authors evaluate the dataset using different machine learning algorithms and demonstrate its effectiveness in detecting various types of attacks.

Table~\ref{tab:cicids2017_breakdown} shows the breakdown of classes in the CICIDS2017 dataset.

\begin{table}[ht]
    \centering
    \begin{tabular}{|l|r|} 
    \hline
    \textbf{Class} & \textbf{Count} \\
    \hline
    Benign & 908,528 \\
    Botnet & 745 \\
    DDoS & 51,234 \\
    DoS GoldenEye & 4,189 \\
    DoS Hulk & 91,856 \\
    DoS Slowhttptest & 2,191 \\
    DoS slowloris & 2,355 \\
    FTP-Patator & 3,184 \\
    Heartbleed & 6 \\
    Infiltration & 18 \\
    PortScan & 63,633 \\
    SSH-Patator & 2,342 \\
    Web Attack Brute Force & 601 \\
    Web Attack SQL Injection & 9 \\
    Web Attack XSS & 260 \\
    \hline
    \end{tabular}
    \caption{CICIDS2017 Dataset Class Breakdown}\label{tab:cicids2017_breakdown}
\end{table}

Comparing the two datasets, it is evident that botnet attacks in the CTU13 dataset share similar characteristics with various attack types in the CICIDS2017 dataset, such as DDoS/DoS attacks, Web attacks, and Bot attacks. These similarities in attack structure and behaviour suggest that machine learning models trained on the CICIDS2017 dataset may be transferable to detecting botnet attacks in the CTU13 dataset.

Several studies have utilised these datasets to develop and evaluate network intrusion detection systems. Chowdhury et al.~\cite{chowdhury2017botnet} proposed a graph-based approach for botnet detection using the CTU13 dataset. They constructed a graph representation of the communication patterns among botnet-infected hosts and applied graph analysis techniques to identify botnets. Their approach achieved high accuracy in detecting botnets and demonstrated the potential of leveraging graph-based features for botnet detection.

Pekta≈ü and Acarman~\cite{pektacs2019deep} applied deep learning techniques to the CTU13 dataset for botnet detection. They used a convolutional neural network (CNN) to learn discriminative features from raw network traffic data. Their proposed model achieved high detection accuracy and showcased the effectiveness of deep learning in capturing complex patterns and behaviours associated with botnets.

Ustebay et al.~\cite{ustebay2018intrusion} proposed an intrusion detection system based on a multi-layer perceptron (MLP) classifier using the CICIDS2017 dataset. They performed extensive preprocessing and feature selection to optimise the input data for the MLP classifier. Their approach achieved high detection accuracy for various attack types in the dataset, demonstrating the potential of neural network-based models for network intrusion detection.

Aksu and Aydin~\cite{aksu2018detecting} conducted a comparative study of different machine learning algorithms for network intrusion detection using the CICIDS2017 dataset. They evaluated the performance of decision trees, random forests, and support vector machines. Their results showed that random forests outperformed other algorithms regarding accuracy and false-positive rates, highlighting the effectiveness of ensemble learning methods for intrusion detection.

While these studies demonstrate the utility of the CTU13 and CICIDS2017 datasets, it is crucial to acknowledge their limitations. Sommer and Paxson~\cite{sommer2010outside} discuss the challenges of using synthetic datasets for network intrusion detection. They argue that synthetic datasets may only partially capture the complexity and diversity of real-world network traffic and may need more crucial contextual information. They emphasise the need for more realistic and representative datasets considering intrusion detection systems' operational aspects and deployment challenges.

Lashkari and colleagues have presented a solution to the constraints surrounding network traffic dataset generation in their study~\cite{lashkari2017characterization}. Their framework utilises methods for producing authentic benign traffic and modelling user actions, resulting in diverse and comprehensive datasets. Additionally, they have introduced the CICFlowMeter tool, which facilitates the extraction of flow-based attributes from unprocessed network traffic data. This tool has become famous for feature extraction and analysis alongside the CICIDS2017 dataset.

However, Engelen et al.~\cite{engelen2021troubleshooting} identified limitations and issues in the CICFlowMeter tool that affect the quality of the extracted features in the CICIDS2017 dataset. They conducted an in-depth dataset analysis and discovered problems related to flow construction, feature extraction, and labelling. They proposed improvements to the CICFlowMeter tool and generated a revised version of the dataset to address these limitations, enhancing the reliability and utility of the dataset for intrusion detection research.

Sommer and Paxson~\cite{sommer2010outside} underscore the significance of utilising unbiased and representative datasets when training machine learning models in network intrusion detection. They draw attention to the obstacles posed by the ever-changing nature of network traffic and attack patterns, which can impact the models' long-term efficacy. Buczak and Guven~\cite{buczak2015survey} present a comprehensive survey of data mining and machine learning techniques for cyber security intrusion detection. They delve into the challenges and considerations of applying machine learning methods to network intrusion detection, such as selecting appropriate algorithms, feature engineering, and model evaluation.

\section{Machine Learning Classifiers}\label{sec:classifiers}

Machine learning classifiers have been widely used in network intrusion detection systems to identify malicious activities and automatically distinguish them from benign traffic. Random Forest (RF) and Support Vector Machine (SVM) are popular classifiers with promising results in this domain.

Random Forest is an ensemble learning method that combines multiple decision trees to make predictions~\cite{hastie2009random}. It constructs many decision trees during the training phase and outputs the majority vote of the individual trees for classification tasks. Random Forest has advantages such as handling high-dimensional data, robustness to noise and outliers, and capturing complex interactions among features.

Farnaaz and Jabbar~\cite{farnaaz2016random} proposed a Random Forest-based model for intrusion detection and evaluated its performance on the NSL-KDD dataset. They performed feature selection using the Chi-square test and trained the Random Forest classifier on the selected features. Their model achieved an accuracy of 99.67\% and a low false positive rate of 0.06\%, demonstrating Random Forest's effectiveness in detecting various types of network attacks.

Belouch et al.~\cite{belouch2018performance} applied Random Forest to the CICIDS2017 dataset for network intrusion detection. They compared the performance of Random Forest with other machine learning algorithms, including Decision Tree, Naive Bayes, and k-Nearest Neighbors. Their results showed that Random Forest outperformed other algorithms, achieving an accuracy of 99.98\% and a false positive rate of 0.01\%. They also analysed the importance of different features in the dataset and identified the most discriminative features for intrusion detection.

Support Vector Machine (SVM) is another widely used classifier in network intrusion detection. SVM aims to find the optimal hyperplane that maximally separates different classes in a high-dimensional feature space~\cite{cortes1995support}. It can handle both linear and non-linear classification tasks using kernel functions. SVM is known for its ability to generalise well, even with limited training data, making it suitable for network intrusion detection scenarios where labelled data may be scarce.

Kabir et al.~\cite{kabir2017network} proposed an SVM-based intrusion detection system and evaluated its performance on the NSL-KDD dataset. They used a genetic algorithm for feature selection and optimised the SVM parameters using grid search. Their proposed system achieved an accuracy of 99.91\% and a detection rate of 99.93\%, showcasing SVM's effectiveness in detecting various types of network attacks.

Teng et al.~\cite{teng2017svm} applied SVM with different kernel functions for intrusion detection on the CICIDS2017 dataset. They compared the performance of linear, polynomial, and radial basis function (RBF) kernels. Their results showed that the RBF kernel achieved the highest accuracy of 97.80\% and a low false positive rate of 0.12\%. They also highlighted the importance of selecting appropriate kernel functions and tuning the SVM parameters for optimal performance.

The choice of a machine learning classifier depends on various factors, such as the dataset's characteristics, the nature of the attacks, and the computational resources available. Buczak and Guven~\cite{buczak2015survey} provide a comprehensive survey of machine learning methods for cyber security intrusion detection. They discuss the strengths and limitations of different classifiers and emphasise the importance of selecting appropriate features, handling imbalanced data, and evaluating the performance of classifiers using relevant metrics.

Comparing the performance of different classifiers on multiple datasets provides valuable insights into their generalisation capabilities and transferability. Training classifiers on one dataset and testing them on another helps assess how well the learned patterns and features can be applied to detect intrusions in different network environments. This approach helps understand the robustness and adaptability of the classifiers across various scenarios.

\section{Explainable AI Techniques}\label{sec:explainable}

While machine learning classifiers have shown promising results in network intrusion detection, their decision-making process is often considered a `black box', lacking transparency and interpretability. Explainable AI techniques aim to bridge this gap by providing insights into the reasoning behind the predictions made by these models.

SHAP (SHapley Additive exPlanations)~\cite{lundberg2017unified} is a popular technique for model interpretation. It is based on the concept of Shapley values from cooperative game theory and provides a unified framework for explaining the output of any machine learning model. SHAP assigns importance scores to each feature, indicating their contribution to the model's prediction for a specific instance. By applying SHAP to trained classifiers, researchers can identify the key features that contribute to detecting particular types of attacks.

Warnecke et al.~\cite{warnecke2020evaluating} evaluated various explanation methods for deep learning-based intrusion detection systems, including SHAP\@ They applied SHAP to a convolutional neural network (CNN) trained on the NSL-KDD dataset and analysed the importance of different features in the model's predictions. They demonstrated that SHAP can provide meaningful insights into the decision-making process of deep learning models and help identify the most influential features for detecting specific attack types.

Amarasinghe et al.~\cite{amarasinghe2018toward} employed SHAP to interpret the predictions of a deep learning-based NIDS.\@They trained a deep neural network on the NSL-KDD dataset and applied SHAP to explain the model's predictions. They analysed the SHAP values to understand the impact of different features on the model's decisions and identified the most discriminative features for detecting specific types of attacks. Their study highlights the potential of SHAP in providing interpretable explanations for deep learning-based NIDS.\@

Mane and Rao~\cite{mane2021explaining} used SHAP to explain the predictions of a random forest classifier for network intrusion detection. They trained the classifier on the NSL-KDD dataset and applied SHAP to interpret the model's predictions. They visualised the SHAP values to understand the contribution of each feature towards the model's output and identified the most critical features for detecting various types of network attacks. Their study demonstrates the effectiveness of SHAP in providing interpretable explanations for ensemble learning methods like random forests.

The insights gained from explainable AI techniques can help validate the reliability of the trained models, identify potential biases or limitations in the datasets, and guide future improvements in feature engineering and model development. Moreover, these insights can be valuable for network security analysts and practitioners in understanding the key factors contributing to detecting specific attacks and developing more targeted defence strategies.