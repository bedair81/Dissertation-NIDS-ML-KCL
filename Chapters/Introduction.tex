\chapter{Introduction}

In an increasingly interconnected world, the security of computer networks is of paramount importance. However, the rapid evolution of cyber threats has made it challenging for traditional signature-based network intrusion detection systems (NIDS) to keep pace with novel and sophisticated attacks~\cite{marchetti2016analysis}. To address this issue, researchers have turned to machine learning approaches, which have the potential to detect previously unseen intrusions by learning patterns and anomalies from network traffic data~\cite{buczak2015survey}.

The effectiveness of machine learning-based NIDS heavily relies on the quality and representativeness of the datasets used for training and evaluation~\cite{engelen2021troubleshooting}. Two widely used datasets in this domain are CTU13~\cite{garcia2014empirical}, which contains real botnet traffic mixed with background traffic, and CICIDS2017~\cite{sharafaldin2018toward}, a more recent dataset that includes a diverse range of modern attacks. However, the transferability and generalisability of machine learning models trained on one dataset to detect intrusions in another remain largely unexplored.

This paper aims to address this gap by investigating the efficacy of using machine learning algorithms trained on the CICIDS2017 dataset to detect botnet attacks in the CTU13 dataset. Specifically, two popular classifiers, Random Forest and Support Vector Machine (SVM), were trained on CICIDS2017 and evaluated their performance on CTU13. This approach allows us to assess the transferability of learned features and patterns across different datasets, simulating a real-world scenario where a model is trained on one dataset and deployed to detect intrusions in the wild.

To guide our experimental design and analysis, we draw upon the recommendations of Arp et al.~\cite{arp2022and} on the best practices for applying machine learning in security. Furthermore, we employ explainable AI techniques, such as SHAP (SHapley Additive exPlanations)~\cite{lundberg2017unified}, to gain insights into the decision-making process of our trained models. By identifying the most important features contributing to the detection of botnet traffic, we aim to uncover the key patterns and characteristics that distinguish malicious and benign network flows.

Additionally, we conduct a comparative analysis of the network flow features extracted from the CTU13 and CICIDS2017 datasets. By exploring the statistical properties and distributions of various features, such as flow duration, packet counts, and inter-arrival times, we seek to understand the inherent differences between actual and simulated network traffic. This analysis sheds light on the challenges and limitations of using synthetic datasets for training NIDS models and emphasises the importance of considering dataset biases in performance evaluation.

Including Random Forest and SVM classifiers in our study enables a more comprehensive assessment of model transferability and generalisability. By comparing their performance and interpreting their predictions using SHAP, we gain valuable insights into the robustness and adaptability of these algorithms in detecting botnet attacks across different datasets.

The remainder of this paper is organised as follows: Section 2 provides background information on the CTU13 and CICIDS2017 datasets, machine learning classifiers, and explainable AI techniques. Section 3 presents a literature review of relevant work in machine learning-based NIDS\@ Section 4 describes the specification and design of our experiments, while Section 5 details the implementation aspects. Section 6 presents the evaluation results and discusses the implications of our findings. Section 7 addresses the legal, social, ethical, and professional issues related to using machine learning in network intrusion detection. Finally, Section 8 concludes the paper and outlines future research directions.